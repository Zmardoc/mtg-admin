import{a as _,c as X,r as d,w as G,y as K,h as u,al as Z,d as J,ak as Y,R as f,S as l,T as m,_ as k,a9 as w,aa as C,ad as h,U as p,V as R,W as S,a8 as ee,X as $,at as te,a7 as ae,au as ne,u as I,ab as re,ac as ie,as as ce,av as oe}from"./index.7f48505b.js";import{a as A,b as D}from"./useNotify.f5979b25.js";import{f as L}from"./InputSearch.e949761f.js";const le={ratio:[String,Number]};function se(e,t){return _(()=>{const r=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(r)!==!0&&r>0?{paddingBottom:`${100/r}%`}:null})}const ue=16/9;var de=X({name:"QImg",props:{...le,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:ue},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:r}){const n=d(e.initialRatio),a=se(e,n);let c=null,v=!1;const s=[d(null),d(F())],o=d(0),g=d(!1),y=d(!1),M=_(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),P=_(()=>({width:e.width,height:e.height})),Q=_(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),U=_(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));G(()=>T(),q);function T(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function F(){return e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null}function q(i){c!==null&&(clearTimeout(c),c=null),y.value=!1,i===null?(g.value=!1,s[o.value^1].value=F()):g.value=!0,s[o.value].value=i}function V({target:i}){v!==!0&&(c!==null&&(clearTimeout(c),c=null),n.value=i.naturalHeight===0?.5:i.naturalWidth/i.naturalHeight,B(i,1))}function B(i,b){v===!0||b===1e3||(i.complete===!0?H(i):c=setTimeout(()=>{c=null,B(i,b+1)},50))}function H(i){v!==!0&&(o.value=o.value^1,s[o.value].value=null,g.value=!1,y.value=!1,r("load",i.currentSrc||i.src))}function O(i){c!==null&&(clearTimeout(c),c=null),g.value=!1,y.value=!0,s[o.value].value=null,s[o.value^1].value=F(),r("error",i)}function z(i){const b=s[i].value,x={key:"img_"+i,class:Q.value,style:U.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...b};return o.value===i?(x.class+=" q-img__image--waiting",Object.assign(x,{onLoad:V,onError:O})):x.class+=" q-img__image--loaded",u("div",{class:"q-img__container absolute-full",key:"img"+i},u("img",x))}function W(){return g.value!==!0?u("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},J(t[y.value===!0?"error":"default"])):u("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[u(Y,{color:e.spinnerColor,size:e.spinnerSize})])}return q(T()),K(()=>{v=!0,c!==null&&(clearTimeout(c),c=null)}),()=>{const i=[];return a.value!==null&&i.push(u("div",{key:"filler",style:a.value})),y.value!==!0&&(s[0].value!==null&&i.push(z(0)),s[1].value!==null&&i.push(z(1))),i.push(u(Z,{name:"q-transition--fade"},W)),u("div",{class:M.value,style:P.value,role:"img","aria-label":e.alt},i)}}});const _e=f({__name:"CollectionNumber",props:{inCollection:{}},setup(e){const t=e,r=_(()=>(t.inCollection,"text-white"));return(n,a)=>(l(),m("div",{class:w(["collection-number mtg-font-bold text-h1 position-absolute",r.value])},k(t.inCollection),3))}});var me=C(_e,[["__scopeId","data-v-6ddf8bbd"]]);const fe=["title"],ve={class:"empty-card__header q-px-xs mtg-font-bold text-black"},ge={class:"empty-card__body text-black"},pe=f({__name:"EmptyCard",props:{cardName:{},oracleText:{}},setup(e){const t=e;return(r,n)=>(l(),m("div",{class:"empty-card flex column justify-between bg-primary",title:t.cardName},[h("div",ve,k(t.cardName),1),h("div",ge,k(t.oracleText),1)],8,fe))}});var Ce=C(pe,[["__scopeId","data-v-100f6d6e"]]);function ye(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"CZK",maximumFractionDigits:2}).format(e)}const he={class:"card-price text-center mtg-font-bold text-subtitle"},Se=24.5,be=f({__name:"CardPrice",props:{prices:{}},setup(e){const t=e,r=_(()=>{if(t.prices.eur){const n=parseFloat(t.prices.eur)*Se;return ye(n)}return"N/A"});return(n,a)=>(l(),m("div",he,k(r.value),1))}});var xe=C(be,[["__scopeId","data-v-000ca823"]]);const ke=f({__name:"ImageCardSingle",props:{cardFace:{},inCollection:{},prices:{}},setup(e){const t=e;return(r,n)=>{var a;return l(),m("div",null,[p(de,{src:(a=t.cardFace.imageUrl)!=null?a:"","spinner-color":"white",fit:"fill",class:"image-card-single"},{error:R(()=>{var c;return[p(Ce,{"card-name":t.cardFace.name,"oracle-text":(c=t.cardFace.oracleText)!=null?c:""},null,8,["card-name","oracle-text"])]}),default:R(()=>[p(me,{"in-collection":t.inCollection},null,8,["in-collection"]),p(xe,{prices:t.prices},null,8,["prices"])]),_:1},8,["src"])])}}});var E=C(ke,[["__scopeId","data-v-7e67a1b8"]]);const Fe=f({__name:"CardButton",props:{icon:{}},setup(e){const t=e;return(r,n)=>(l(),S(ee,{round:"",icon:t.icon,class:"card-button"},null,8,["icon"]))}});var N=C(Fe,[["__scopeId","data-v-ad057942"]]);const we={class:"card-menu flex column"},$e=f({__name:"CardMenu",props:{inCollection:{}},emits:["add","remove"],setup(e,{emit:t}){const r=e;return(n,a)=>(l(),m("div",we,[p(N,{icon:"add",color:"black",onClick:a[0]||(a[0]=c=>t("add"))}),r.inCollection>0?(l(),S(N,{key:0,icon:"remove",color:"black",onClick:a[1]||(a[1]=c=>t("remove"))})):$("",!0)]))}});var Ie=C($e,[["__scopeId","data-v-5935d9cf"]]);function Ne(e){const{notifySuccess:t}=A();async function r(n){const a=await te("/api/card/upsert",{name:n});return a&&(t(`${n} was added to your collection`),e(a)),a}return D({mutationFn:r})}const j=ae("scanner",()=>{const e=d([]);function t(n){e.value.find(a=>a.id===n.id)||(e.value=[...new Set([...e.value,n])])}function r(n){e.value=e.value.map(a=>({...a,inCollection:a.frontFace.name===n.name?n.inCollection:a.inCollection}))}return{scannedCards:e,addToScannedCards:t,updateScannedCards:r}});function Te(){const{updateSearch:e}=L(),{updateScannedCards:t}=j();function r(a){e(a),t(a)}const{mutate:n}=Ne(r);return n}function qe(e){const{notifySuccess:t}=A();async function r(n){const a=await ne(`/api/card?name=${n}`);return e(a),t(`${n} was removed from your collection`),a}return D({mutationFn:r})}function Be(){const{updateSearch:e}=L(),{updateScannedCards:t}=j();function r(a){e(a),t(a)}const{mutate:n}=qe(r);return n}const ze=e=>(re("data-v-4b1b3210"),e=e(),ie(),e),Re={class:"image-card-scene"},Ee=ze(()=>h("div",{class:"image-card-scene__hover"},null,-1)),Ae=f({__name:"ImageCard",props:{card:{}},setup(e){const t=e,r=Te(),n=Be(),a=d(!1),c=_(()=>!!t.card.backFace);function v(){t.card.backFace&&(a.value=!a.value)}return(s,o)=>(l(),m("div",Re,[p(Ie,{onAdd:o[0]||(o[0]=g=>I(r)(t.card.frontFace.name)),onRemove:o[1]||(o[1]=g=>I(n)(t.card.frontFace.name)),onFlip:v,showFlip:c.value,inCollection:t.card.inCollection,class:"image-card-scene__menu absolute"},null,8,["showFlip","inCollection"]),c.value?(l(),S(N,{key:0,icon:"auto_stories",class:"image-card-scene__flip absolute",onClick:v})):$("",!0),h("div",{class:w(["full-width full-height",{"image-card-container--not-in-collection":t.card.inCollection===0}])},[h("div",{class:w(["image-card",{"image-card--is-flipped":a.value}])},[p(E,{"card-face":t.card.frontFace,"in-collection":t.card.inCollection,prices:t.card.prices,class:"image-card__face image-card__face--front"},null,8,["card-face","in-collection","prices"]),t.card.backFace?(l(),S(E,{key:0,"card-face":t.card.backFace,"in-collection":t.card.inCollection,prices:t.card.prices,class:"image-card__face image-card__face--back"},null,8,["card-face","in-collection","prices"])):$("",!0)],2)],2),Ee]))}});var De=C(Ae,[["__scopeId","data-v-4b1b3210"]]);const Le={class:"flex justify-center q-py-xs"},Qe=f({__name:"CardList",props:{cards:{}},setup(e){const t=e;return(r,n)=>(l(),m("div",Le,[(l(!0),m(ce,null,oe(t.cards,a=>(l(),S(I(De),{key:a.id,card:a,class:"q-ma-xs"},null,8,["card"]))),128))]))}});export{Qe as _,j as u};
